import numpy as np
mu, sigma = 0, 0.1
x = np.array([[1,2,4],[2,2,3],[1,1,3]])
# creating a noise with the same dimension as the dataset (2,2)
noise = np.random.normal(mu, sigma, [3,3])
# print(noise+x)

train = np.loadtxt("../../../../tina_dataset/cnn_benign_train.csv", delimiter=",", skiprows=1)
import pandas as pd
df = pd.DataFrame(train)
Q1 = df.quantile(0.05)
Q3 = df.quantile(0.95)
IQR = Q3 - Q1
clean_train = df[~((df < (Q1 - 1.5 * IQR)) | (df > (Q3 + 1.5 * IQR))).any(axis=1)]
print(clean_train.shape)
print(train.shape)
df.to_csv('../../../../tina_dataset/clear_cnn_benign_train.csv')